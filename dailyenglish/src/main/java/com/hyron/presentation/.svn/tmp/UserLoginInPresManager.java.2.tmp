package com.hyron.presentation;

import java.util.ArrayList;
import java.util.List;

import javax.faces.context.FacesContext;
import javax.servlet.http.HttpSession;

import org.directwebremoting.WebContextFactory;

import com.hyron.common.Role;
import com.hyron.db.domain.User;
import com.hyron.exception.BusinessException;
import com.hyron.facade.UserLoginInFacade;
import com.hyron.javabean.UserBean;
import com.hyron.utils.BeanBuild;

public class UserLoginInPresManager {
	public static final String USER_SESSION_NAME = "username";
	public static final String USER_SESSION_ROLE = "role";
	public static final boolean user_SESSION_LOGIN = true;
	public static final boolean user_SESSION_LOGOUT = false;
	private String userSessionName = null;
	public UserLoginInFacade userLoginInFacade;

	public UserLoginInFacade getUserLoginInFacade() {
		return userLoginInFacade;
	}

	public void setUserLoginInFacade(UserLoginInFacade userLoginInFacade) {
		this.userLoginInFacade = userLoginInFacade;
	}

	public List<UserBean> userLoginIn(String userNameorEmail, String passWord) throws BusinessException{
		List<UserBean> ubs = new ArrayList<UserBean>();
		try {
			List<User> users = userLoginInFacade.userLoginIn(userNameorEmail,
					passWord);
			if(users.size()<1){
				throw new BusinessException("get user error");
			}
			ubs = BeanBuild.buildUserBean(users);
			userSessionName = ubs.get(0).getNickName();
			if (null != ubs) {
				 HttpSession session = WebContextFactory.get().getSession();
				 session.setAttribute(USER_SESSION_NAME, "huan");
			}
		} catch (Exception be) {
			throw new BusinessException("Login error");
		}
		return ubs;
	}
<<<<<<< .mine
	
	public String getLoginUser(){
		HttpSession session = WebContextFactory.get().getSession();
		String username = (String) session.getAttribute(USER_SESSION_NAME);
		return username;
	}
=======
	
	public boolean saveUserLoginSession(String userNameorEmail){
		if(userNameorEmail == userSessionName){
			userSessionName = userNameorEmail;
		}
		return user_SESSION_LOGIN;
	}
	
	public String getUserLoginSession(){
		return userSessionName;
	}
	
	public boolean userLogout(String userName){
		if(userSessionName == userName){
			userSessionName = null;
		}
		userSessionName = null;
		return user_SESSION_LOGOUT;
	}
>>>>>>> .r26

	public String getUserName() {
		return userSessionName;
	}

	public void setUserName(String userName) {
		this.userSessionName = userName;
	}
	
	

}
